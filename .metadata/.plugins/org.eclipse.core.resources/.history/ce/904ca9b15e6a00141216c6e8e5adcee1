package com.example.jogodeadivinha;

import android.app.Activity;
import android.content.Intent;
import android.os.Bundle;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.EditText;
import android.widget.TextView;

import com.example.jogodeadivinha.model.JogoDeAdivinha;
import com.example.jogodeadivinha.util.Util;

public class Jogar extends Activity {

	private final static String NUMERO_JOGADA = "JOGADA";
	private JogoDeAdivinha mJogo;
	private TextView mTvDebugJogo;
	private EditText mEtNumJogada;
	private Button mBtnJogar, mBtnRestart;
	private int min, max,numeroJogada;

	@Override
	protected void onCreate(Bundle savedInstanceState) {
		super.onCreate(savedInstanceState);

		this.setContentView(R.layout.activity_jogar);

		init();

		getDataFromBundle();
		
		mJogo = new JogoDeAdivinha(min, max);
		
		numeroJogada = Util.getInt(mEtNumJogada);
		
		addListenersToButton();
		
	}

	private void addListenersToButton() {
		mBtnJogar.setOnClickListener(listener);
		mBtnRestart.setOnClickListener(listener);
	}

	@Override
	protected void onSaveInstanceState(Bundle outState) {
		super.onSaveInstanceState(outState);
		outState.putInt(NUMERO_JOGADA, numeroJogada);
	}
	
	@Override
	protected void onRestoreInstanceState(Bundle savedInstanceState) {
		super.onRestoreInstanceState(savedInstanceState);
		numeroJogada = savedInstanceState.getInt(NUMERO_JOGADA);
	}
	
	
	private void getDataFromBundle() {
		Bundle extras = getIntent().getExtras();

		min = extras.getInt(Inicial.MINIMO);
		max = extras.getInt(Inicial.MAXIMO);
		
		if(min>max){
			int aux = min;
			min = max;
			max = aux;
		}
		mTvDebugJogo.setText(min + " - " + max);
	}

	private void init() {
		mTvDebugJogo = (TextView) findViewById(R.id.id_tv_debug_jogar);
		mEtNumJogada = (EditText) findViewById(R.id.id_et_numero_jogado);
		mBtnJogar = (Button)findViewById(R.id.id_btn_jogar);
		mBtnRestart = (Button)findViewById(R.id.id_btn_restart);
	}

	
	private View.OnClickListener listener = new OnClickListener() {
		
		@Override
		public void onClick(View v) {
			switch(v.getId()){
			case R.id.id_btn_jogar:
//				mJogo.jogar(Util.getInt(mEtNumJogada));
//				mTvDebugJogo.setText(mJogo.estadoDoJogoEnquantoFrase());
				jogar();
				break;
			case R.id.id_btn_restart:
				reiniciar();
				break;
			}
		}
	};

	protected void reiniciar() {
		Intent intent = new Intent(Jogar.this, Inicial.class);
		startActivity(intent);
		finish();
	}


	protected void jogar() {
		Util.fazerAparecerUmaBreveMensagem("Jogando", Jogar.this);
	}
	
}
